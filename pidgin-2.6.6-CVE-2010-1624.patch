diff -up pidgin-2.6.6/libpurple/protocols/msn/slp.c.CVE-2010-1624 pidgin-2.6.6/libpurple/protocols/msn/slp.c
--- pidgin-2.6.6/libpurple/protocols/msn/slp.c.CVE-2010-1624	2010-02-16 04:34:06.000000000 -0500
+++ pidgin-2.6.6/libpurple/protocols/msn/slp.c	2010-05-13 11:38:47.128099766 -0400
@@ -930,6 +930,8 @@ msn_emoticon_msg(MsnCmdProc *cmdproc, Ms
 	conv = swboard->conv;
 
 	body = msn_message_get_bin_data(msg, &body_len);
+	if (!body || !body_len)
+		return;
 	body_str = g_strndup(body, body_len);
 
 	/* MSN Messenger 7 may send more than one MSNObject in a single message...
